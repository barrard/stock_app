(window.webpackJsonp=window.webpackJsonp||[]).push([["fff3"],{IT5z:function(e,t,n){"use strict";n.r(t);var a=n("Rbzu"),r=n("hDBU"),o=n("JYC+"),l=n.n(o),c=n("UrUy"),s=n.n(c),i=n("0tNF"),u=n("8ET1"),d=n.n(u),m=n("R3/3"),p=n("azxR"),f=n("LkAs"),_=n("Moms"),h=n("bMj6"),v=n("hZod"),b=n("YKN3"),g=n("tEuJ"),E=n("mXGw"),y=n.n(E),k=n("/m4v"),w=n("RIvd"),N=n("bBV7"),x=n("4cCf"),j=function(e){function t(e){var n;return Object(f.default)(this,t),(n=Object(h.default)(this,Object(v.default)(t).call(this,e))).state={posts:e.posts,direction:"",symbol:"",img:"",entry:"",stop:"",first_target:"",second_target:"",certainty:"",notes:"",edit_mode:!1,edit_id:"",file_name:""},n.submit_new_post=n.submit_new_post.bind(Object(b.default)(n)),n.readIMG=n.readIMG.bind(Object(b.default)(n)),n.handle_edit_click=n.handle_edit_click.bind(Object(b.default)(n)),n}return Object(g.default)(t,e),Object(_.default)(t,[{key:"componentDidMount",value:function(){}},{key:"handle_input",value:function(e,t){this.setState(Object(p.a)({},t,e.target.value)),console.log({prop:t})}},{key:"submit_new_post",value:function(){var e=Object(m.default)(s.a.mark(function e(t){var n,a,r,o,l,c,u;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o in e.prev=0,t.preventDefault(),console.log(t),console.log(this.state),n=d()(document.querySelector("[type=file]").files),a=new FormData,console.log(n),n&&n.forEach(function(e){return a.append("files[]",e)}),r=this.state)console.log(o,r[o]),a.append(o,r[o]);return console.log(a),console.log(this.props.meta.csrf),e.next=14,fetch("/admin/add_trade_post",{method:"POST",headers:{"csrf-token":this.props.meta.csrf},body:a});case 14:return l=e.sent,w.toastr.success("New Post Created!"),this.setState({symbol:"",img:"",entry:"",stop:"",first_target:"",second_target:"",certainty:"",notes:""}),e.next=19,l.json();case 19:if(!(c=e.sent).err){e.next=22;break}throw"Error making new post";case 22:console.log(c),u=[c].concat(Object(i.default)(this.state.posts)),this.setState({posts:u}),e.next=32;break;case 27:e.prev=27,e.t0=e.catch(0),console.log("err"),console.log(e.t0),w.toastr.error(e.t0);case 32:case"end":return e.stop()}},e,this,[[0,27]])}));return function(t){return e.apply(this,arguments)}}()},{key:"readIMG",value:function(e){if(console.log("upload"),e.files&&e.files[0]){this.setState({img:e.files[0].name});var t=new FileReader;t.onload=function(e){$("#chart").attr("src",e.target.result)},t.readAsDataURL(e.files[0])}}},{key:"handle_delete_click",value:function(){var e=Object(m.default)(s.a.mark(function e(t){var n,a,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("Are yo usure you want to delete this?")){e.next=3;break}return e.abrupt("return");case 3:return console.log({id:t}),e.next=6,fetch("/admin/delete_post",{method:"POST",headers:{"csrf-token":this.props.meta.csrf,"Content-Type":"application/json"},body:l()({id:t})});case 6:if(n=e.sent,a=n.err,n.ok,!a){e.next=10;break}return e.abrupt("return",w.toastr.error(a));case 10:r=this.state.posts.filter(function(e){return e._id!==t}),console.log({posts:r}),console.log(this.props),this.setState({posts:r});case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handle_edit_click",value:function(e){console.log({id:e});var t=this.props.posts.filter(function(t){return t._id==e}),n=Object(r.default)(t,1)[0];console.log({post:n});var o=Object(a.a)({},this.state,n,{edit_mode:!0,edit_id:n._id});this.setState(Object(a.a)({},o))}},{key:"render",value:function(){var e=this,t=this.state,n=t.posts,a=t.symbol,r=t.file_name,o=(t.img,t.entry),l=t.stop,c=t.first_target,s=t.second_target,i=t.certainty,u=t.notes,d=t.edit_mode,m=t.diretion,p=t.edit_id;return y.a.createElement(x.a,null,y.a.createElement("div",{className:"container vh_100"},y.a.createElement("div",{className:"row flex_center relative "},y.a.createElement("div",{className:"col-sm-6 absolute trade_post_form_overlay transparent"},y.a.createElement(G,{diretion:m,symbol:a,entry:o,stop:l,first_target:c,second_target:s,certainty:i,notes:u,edit_mode:d,edit_id:p,readIMG:this.readIMG,submit_new_post:this.submit_new_post,handle_input:function(t,n){return e.handle_input(t,n)}})),y.a.createElement("div",{className:"col-sm-12 flex_center under_1"},y.a.createElement("img",{className:"full-width",src:this.state.edit_mode?"/static/trade_post_imgs/".concat(r):"",alt:"",id:"chart"})))),y.a.createElement("div",{className:"row flex_center"},y.a.createElement("div",{className:"col-sm-12 "},n&&n.length>0&&y.a.createElement(O,{handle_delete_click:function(t){return e.handle_delete_click(t)},handle_edit_click:function(t){return e.handle_edit_click(t)},posts:n}))))}}],[{key:"getInitialProps",value:function(){var e=Object(m.default)(s.a.mark(function e(t){var n,a,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("ADMIN"),e.prev=1,e.next=4,fetch("http://localhost:3000/trade_posts");case 4:return n=e.sent,e.next=7,n.json();case 7:return a=e.sent,r=a.posts,console.log({posts:r}),e.abrupt("return",{posts:r});case 13:return e.prev=13,e.t0=e.catch(1),console.log("err"),console.log(e.t0),e.abrupt("return",{});case 18:case"end":return e.stop()}},e,null,[[1,13]])}));return function(t){return e.apply(this,arguments)}}()}]),t}(y.a.Component);t.default=Object(k.connect)(function(e){return{user:e.user,meta:e.meta}})(Object(N.withRouter)(j));var O=function(e){var t=e.posts,n=e.handle_edit_click,a=e.handle_delete_click;return y.a.createElement("div",{className:"row "},y.a.createElement("div",{className:"col-sm-12 "},t.map(function(e,t){return y.a.createElement(C,{key:t,index:t,post:e,handle_edit_click:function(e){return n(e)},handle_delete_click:function(e){return a(e)}})})))},C=function(e){var t=e.post,n=e.index,a=e.handle_edit_click,r=e.handle_delete_click,o=n%2==0?"ticker_row_light":"ticker_row_dark";return y.a.createElement("div",{className:"".concat(o," row flex_center")},y.a.createElement("div",{className:"col-sm-2 flex_center"},y.a.createElement(T,{symbol:t.symbol})),y.a.createElement("div",{className:"col-sm-2 flex_center"},y.a.createElement(S,{handle_click:function(e){return a(t._id)}})),y.a.createElement("div",{className:"col-sm-2 flex_center"},y.a.createElement(I,{handle_click:function(e){return r(t._id)}})))},S=function(e){var t=e.handle_click;return y.a.createElement("button",{onClick:t,type:"button",className:"btn btn-info"},"EDIT")},I=function(e){var t=e.handle_click;return y.a.createElement("button",{onClick:t,type:"button",className:"btn btn-danger"},"Delete")},T=function(e){var t=e.symbol;return y.a.createElement("span",{className:"ticker_symbol"},t)},M=function(e){var t=e.val,n=e.handle_input;return y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"trade direction"},"Trade Direction"),y.a.createElement("select",{value:t,onChange:function(e){return n(e,"direction")},className:"form-control opaque"},y.a.createElement("option",{value:"long"},"Long"),y.a.createElement("option",{value:"short"},"Short")))},D=function(e){var t=e.val,n=e.handle_input;return y.a.createElement("div",{className:"form-group"},y.a.createElement("label",null,"Level Of Certainty"),y.a.createElement("select",{value:t,onChange:function(e){return n(e,"certainty")},className:"form-control opaque"},y.a.createElement("option",{value:"1"},"1"),y.a.createElement("option",{value:"2"},"2"),y.a.createElement("option",{value:"3"},"3"),y.a.createElement("option",{value:"4"},"4"),y.a.createElement("option",{value:"5"},"5")))},F=function(e){var t=e.val,n=e.handle_input;return y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"Notes"},"Notes"),y.a.createElement("textarea",{value:t,onChange:function(e){return n(e,"notes")},className:"form-control opaque",rows:"3"}))},G=function(e){var t=e.handle_input,n=e.submit_new_post,a=e.readIMG,r=e.symbol,o=e.diretion,l=(e.img,e.entry),c=e.stop,s=e.first_target,i=e.second_target,u=e.certainty,d=e.notes;e.edit_mode,e.edit_id;return y.a.createElement("form",null,y.a.createElement("input",{type:"file",name:"chart",onChange:function(e){return a(e.target)}}),y.a.createElement(R,{val:r,label:"Symbol",prop:"symbol",handle_input:t}),y.a.createElement(R,{val:l,label:"Entry",prop:"entry",handle_input:t}),y.a.createElement(R,{val:c,label:"Stop",prop:"stop",handle_input:t}),y.a.createElement(R,{val:s,label:"First Target",prop:"first_target",handle_input:t}),y.a.createElement(R,{val:i,label:"Second Target",prop:"second_target",handle_input:t}),y.a.createElement(M,{val:o,handle_input:function(e,n){return t(e,n)}}),y.a.createElement(D,{val:u,handle_input:function(e,n){return t(e,n)}}),y.a.createElement(F,{val:d,handle_input:function(e,n){return t(e,n)}}),y.a.createElement("button",{onClick:function(e){return n(e)}},"Submit"))},R=function(e){var t=e.val,n=e.label,a=e.prop,r=e.handle_input;return y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"symbol"},n),y.a.createElement("input",{value:t,onChange:function(e){return r(e,a)},type:"text",className:"form-control opaque",placeholder:n}))}},pyW7:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){var e=n("IT5z");return{page:e.default||e}}])}},[["pyW7","5d41","9da1"]]]);