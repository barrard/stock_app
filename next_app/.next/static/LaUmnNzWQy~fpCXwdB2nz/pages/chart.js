(window.webpackJsonp=window.webpackJsonp||[]).push([["7c83"],{"3/Lt":function(e,t,n){"use strict";n.d(t,"d",function(){return c}),n.d(t,"a",function(){return u}),n.d(t,"e",function(){return f}),n.d(t,"b",function(){return p}),n.d(t,"c",function(){return _}),n.d(t,"f",function(){return d});var a=n("JYC+"),r=n.n(a),o=n("UrUy"),i=n.n(o),l=n("R3/3"),s=n("RIvd");function c(e){return{type:"SET_MA_QUERY",queries:e}}function u(e){if(e.length>=3)return s.toastr.info("Three is enough");return e.push({MA:"50",g_l:"g",perc:20}),{type:"ADD_QUERY",queries:e}}function f(e,t){return{type:"SORT_BY",prop:e,flag:t}}function p(e){return function(){var t=Object(l.default)(i.a.mark(function t(n){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"IS_LOADING",is_loading:!0}),setTimeout(function(){n({type:"SORT_BY",prop:e,flag:!0}),n({type:"IS_LOADING",is_loading:!1})},0),n({type:"LOAD_MORE_MA_RESULTS"});case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}function _(e,t){return t.splice(e,1),{type:"REMOVE_QUERY",queries:t}}function d(e,t){e.query;return function(){var n=Object(l.default)(i.a.mark(function n(a){var o,l;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:"IS_LOADING",is_loading:!0}),a({type:"CLEAR_RESULTS"}),n.prev=2,n.next=5,fetch("/MA-query",{method:"POST",headers:{"Content-Type":"application/json"},body:r()(e)});case 5:return o=n.sent,n.next=8,o.json();case 8:l=n.sent,console.log(l),a({type:"IS_LOADING",is_loading:!1}),a({type:"QUERY_SUBMITTED",query_results:l,saved_queries:t}),n.next=19;break;case 14:n.prev=14,n.t0=n.catch(2),console.log("err"),console.log(n.t0),s.toastr.error("N/A");case 19:case"end":return n.stop()}},n,null,[[2,14]])}));return function(e){return n.apply(this,arguments)}}()}},"4DfG":function(e,t,n){"use strict";e.exports=n("UdKW")},"79+t":function(e,t,n){var a=n("/6KZ"),r=n("bvQF");a(a.G+a.F*(parseInt!=r),{parseInt:r})},"8cf0":function(e,t,n){var a=n("/6KZ"),r=n("Xj5l"),o=n("/Vl9"),i=n("M5cM"),l="["+i+"]",s=RegExp("^"+l+l+"*"),c=RegExp(l+l+"*$"),u=function(e,t,n){var r={},l=o(function(){return!!i[e]()||"​"!="​"[e]()}),s=r[e]=l?t(f):i[e];n&&(r[n]=s),a(a.P+a.F*l,"String",r)},f=u.trim=function(e,t){return e=String(r(e)),1&t&&(e=e.replace(s,"")),2&t&&(e=e.replace(c,"")),e};e.exports=u},AT0B:function(e,t,n){n("QTEN"),e.exports=n("TaGV").parseFloat},FdmI:function(e,t,n){e.exports=n("n7m4")},IPCE:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chart",function(){var e=n("xomw");return{page:e.default||e}}])},M5cM:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},QTEN:function(e,t,n){var a=n("/6KZ"),r=n("ZqaM");a(a.G+a.F*(parseFloat!=r),{parseFloat:r})},UdKW:function(e,t,n){"use strict";(function(e){
/** @license React v0.13.6
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
Object.defineProperty(t,"__esModule",{value:!0});var n=null,a=!1,r=3,o=-1,i=-1,l=!1,s=!1;function c(){if(!l){var e=n.expirationTime;s?k():s=!0,x(p,e)}}function u(){var e=n,t=n.next;if(n===t)n=null;else{var a=n.previous;n=a.next=t,t.previous=a}e.next=e.previous=null,a=e.callback,t=e.expirationTime,e=e.priorityLevel;var o=r,l=i;r=e,i=t;try{var s=a()}finally{r=o,i=l}if("function"==typeof s)if(s={callback:s,priorityLevel:e,expirationTime:t,next:null,previous:null},null===n)n=s.next=s.previous=s;else{a=null,e=n;do{if(e.expirationTime>=t){a=e;break}e=e.next}while(e!==n);null===a?a=n:a===n&&(n=s,c()),(t=a.previous).next=a.previous=s,s.next=a,s.previous=t}}function f(){if(-1===o&&null!==n&&1===n.priorityLevel){l=!0;try{do{u()}while(null!==n&&1===n.priorityLevel)}finally{l=!1,null!==n?c():s=!1}}}function p(e){l=!0;var r=a;a=e;try{if(e)for(;null!==n;){var o=t.unstable_now();if(!(n.expirationTime<=o))break;do{u()}while(null!==n&&n.expirationTime<=o)}else if(null!==n)do{u()}while(null!==n&&!T())}finally{l=!1,a=r,null!==n?c():s=!1,f()}}var _,d,v=Date,h="function"==typeof setTimeout?setTimeout:void 0,m="function"==typeof clearTimeout?clearTimeout:void 0,g="function"==typeof requestAnimationFrame?requestAnimationFrame:void 0,y="function"==typeof cancelAnimationFrame?cancelAnimationFrame:void 0;function b(e){_=g(function(t){m(d),e(t)}),d=h(function(){y(_),e(t.unstable_now())},100)}if("object"==typeof performance&&"function"==typeof performance.now){var w=performance;t.unstable_now=function(){return w.now()}}else t.unstable_now=function(){return v.now()};var x,k,T,M=null;if("undefined"!=typeof window?M=window:void 0!==e&&(M=e),M&&M._schedMock){var E=M._schedMock;x=E[0],k=E[1],T=E[2],t.unstable_now=E[3]}else if("undefined"==typeof window||"function"!=typeof MessageChannel){var A=null,S=function(e){if(null!==A)try{A(e)}finally{A=null}};x=function(e){null!==A?setTimeout(x,0,e):(A=e,setTimeout(S,0,!1))},k=function(){A=null},T=function(){return!1}}else{"undefined"!=typeof console&&("function"!=typeof g&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof y&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));var O=null,I=!1,R=-1,j=!1,F=!1,C=0,P=33,D=33;T=function(){return C<=t.unstable_now()};var L=new MessageChannel,N=L.port2;L.port1.onmessage=function(){I=!1;var e=O,n=R;O=null,R=-1;var a=t.unstable_now(),r=!1;if(0>=C-a){if(!(-1!==n&&n<=a))return j||(j=!0,b(U)),O=e,void(R=n);r=!0}if(null!==e){F=!0;try{e(r)}finally{F=!1}}};var U=function(e){if(null!==O){b(U);var t=e-C+D;t<D&&P<D?(8>t&&(t=8),D=t<P?P:t):P=t,C=e+D,I||(I=!0,N.postMessage(void 0))}else j=!1};x=function(e,t){O=e,R=t,F||0>t?N.postMessage(void 0):j||(j=!0,b(U))},k=function(){O=null,I=!1,R=-1}}t.unstable_ImmediatePriority=1,t.unstable_UserBlockingPriority=2,t.unstable_NormalPriority=3,t.unstable_IdlePriority=5,t.unstable_LowPriority=4,t.unstable_runWithPriority=function(e,n){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var a=r,i=o;r=e,o=t.unstable_now();try{return n()}finally{r=a,o=i,f()}},t.unstable_next=function(e){switch(r){case 1:case 2:case 3:var n=3;break;default:n=r}var a=r,i=o;r=n,o=t.unstable_now();try{return e()}finally{r=a,o=i,f()}},t.unstable_scheduleCallback=function(e,a){var i=-1!==o?o:t.unstable_now();if("object"==typeof a&&null!==a&&"number"==typeof a.timeout)a=i+a.timeout;else switch(r){case 1:a=i+-1;break;case 2:a=i+250;break;case 5:a=i+1073741823;break;case 4:a=i+1e4;break;default:a=i+5e3}if(e={callback:e,priorityLevel:r,expirationTime:a,next:null,previous:null},null===n)n=e.next=e.previous=e,c();else{i=null;var l=n;do{if(l.expirationTime>a){i=l;break}l=l.next}while(l!==n);null===i?i=n:i===n&&(n=e,c()),(a=i.previous).next=i.previous=e,e.next=i,e.previous=a}return e},t.unstable_cancelCallback=function(e){var t=e.next;if(null!==t){if(t===e)n=null;else{e===n&&(n=t);var a=e.previous;a.next=t,t.previous=a}e.next=e.previous=null}},t.unstable_wrapCallback=function(e){var n=r;return function(){var a=r,i=o;r=n,o=t.unstable_now();try{return e.apply(this,arguments)}finally{r=a,o=i,f()}}},t.unstable_getCurrentPriorityLevel=function(){return r},t.unstable_shouldYield=function(){return!a&&(null!==n&&n.expirationTime<i||T())},t.unstable_continueExecution=function(){null!==n&&c()},t.unstable_pauseExecution=function(){},t.unstable_getFirstCallbackNode=function(){return n}}).call(this,n("pCvA"))},ZqaM:function(e,t,n){var a=n("41F1").parseFloat,r=n("8cf0").trim;e.exports=1/a(n("M5cM")+"-0")!=-1/0?function(e){var t=r(String(e),3),n=a(t);return 0===n&&"-"==t.charAt(0)?-0:n}:a},bvQF:function(e,t,n){var a=n("41F1").parseInt,r=n("8cf0").trim,o=n("M5cM"),i=/^[-+]?0[xX]/;e.exports=8!==a(o+"08")||22!==a(o+"0x16")?function(e,t){var n=r(String(e),3);return a(n,t>>>0||(i.test(n)?16:10))}:a},n7m4:function(e,t,n){n("79+t"),e.exports=n("TaGV").parseInt},xomw:function(e,t,n){"use strict";n.r(t);var a=n("UrUy"),r=n.n(a),o=n("R3/3"),i=n("LkAs"),l=n("Moms"),s=n("bMj6"),c=n("hZod"),u=n("tEuJ"),f=n("mXGw"),p=n.n(f),_=n("/m4v"),d=(n("RIvd"),n("bBV7")),v=(n("heMW"),n("4cCf")),h=n("HyVD"),m=n("yLsn"),g=n.n(m),y=n("FdmI"),b=n.n(y),w=n("YKN3"),x=n("xARA"),k=n.n(x),T=(n("3/Lt"),function(e){function t(e){var n;return Object(i.default)(this,t),(n=Object(s.default)(this,Object(c.default)(t).call(this,e))).state={canvas_width:null,canvas_height:null,chart_height:"",vol_canvas_height:"",canvas:"",context:{},candle_width:3,space_between_bars:.5,x_offset:0,data_loaded:!1,crosshair_overlay:"",volume_canvas:"",volume_canvas_overlay:"",vol_canvas_share:.1,overlay_offset:"",symbol:"",spinner_timmer:"",MA_data:{},chart_background:"white"},n.draw_cross_hair=n.draw_cross_hair.bind(Object(w.default)(n)),n}return Object(u.default)(t,e),Object(l.default)(t,[{key:"componentDidMount",value:function(){console.log("canvas mounted"),this.make_canvas_full_screen()}},{key:"componentDidUpdate",value:function(e){console.log("componentDidUpdate"),console.log(e),!e.meta.is_loading&&this.props.meta.is_loading&&this.run_spinner()}},{key:"make_canvas_full_screen",value:function(){var e=this;if("undefined"!=typeof window){var t=k.a.findDOMNode(this),n=(this.props.canvas_id,.95*t.parentElement.clientWidth),a=t.parentElement.clientHeight;this.setState({canvas_width:n,canvas_height:a}),setTimeout(function(){var t=document.getElementById(e.props.canvas_id),n=document.getElementById("".concat(e.props.canvas_id,"_crosshair_overlay")),a=document.getElementById("".concat(e.props.canvas_id,"_crosshair_overlay")).getBoundingClientRect();e.run_spinner(t),e.setState({overlay_offset:a,canvas:t,crosshair_overlay:n}),console.log("does this run?"),console.log(e)},0)}}},{key:"run_spinner",value:function(){var e=this,t=document.getElementById(this.props.canvas_id).getContext("2d"),n=new Date,a=t.canvas.width,r=t.canvas.height,o=setInterval(function(){if(!e.props.meta.is_loading){clearInterval(e.state.spinner_timmer),console.log(e.props.stock_data),console.log(e.props.canvas_id),console.log(e.props.stock_data.charts[e.props.canvas_id]);var o=e.props.stock_data.charts[e.props.canvas_id].chart_data;console.log({chart_data:o});var i=function(e){for(var t=(new Date).getTime(),n={MA_20:[],MA_50:[],MA_200:[]},a=e.length,r=-1;r<a-20;){var o=++r+20,i=50+r,l=200+r;if(a>=20){var s=S(r,o,e),c=A(s);n.MA_20[o-1]=c}if(a>=i){var u=S(r,i,e),f=A(u);n.MA_50[i-1]=f}if(a>=l){var p=S(r,l,e),_=A(p);n.MA_200[l-1]=_}}console.log("done with ");var d=(new Date).getTime();return console.log(d-t),n}(o);return console.log(i),e.setState({MA_data:i}),e.draw_chart(e.state.chart_background)}var l=b()((new Date-n)/1e3*16)/16;t.save(),t.clearRect(0,0,a,r),t.translate(a/2,r/2),t.rotate(2*Math.PI*l);for(var s=0;s<16;s++)t.beginPath(),t.rotate(2*Math.PI/16),t.moveTo(a/10,0),t.lineTo(a/4,0),t.lineWidth=a/30,t.strokeStyle="rgba(0, 0, 0,"+s/16+")",t.stroke();t.restore()},1e3/30);this.setState({spinner_timmer:o})}},{key:"render_canvas",value:function(e,t,n){return p.a.createElement(p.a.Fragment,null,p.a.createElement("canvas",{onMouseMove:this.draw_cross_hair,className:"crosshair_overlay absolute",id:"".concat(e,"_crosshair_overlay"),width:t,height:n}),p.a.createElement("canvas",{onMouseMove:this.draw_cross_hair,className:"chart_canvas",id:e,width:t,height:n}))}},{key:"draw_cross_hair",value:function(e){var t,n,a=this.state,r=a.overlay_offset,o=a.crosshair_overlay,i=a.min_price,l=a.pennies_per_pixel,s=a.candle_width,c=a.space_between_bars,u={left:e.pageX-r.left,top:e.pageY-r.top},f=u.left,p=u.top,_=o,d=g()(i+(_.height-p)*l/100).toFixed(2),v=_.getContext("2d");v.clearRect(0,0,_.width,_.height),v.beginPath(),v.moveTo(0,p),v.lineTo(_.width,p),v.stroke(),v.beginPath(),v.moveTo(f,0),v.lineTo(f,_.height),v.stroke(),t=f+50>_.width?f-50:f+10,n=p+50>_.height?p-50:p+15;var h=Math.floor(f/(s+c));console.log({candle_id:h}),console.log(m),E(d,"black",14,v,t,n);var m=this.props.data.chart_data[h];m&&E(m.date,"black",14,v,f,_.height)}},{key:"draw_chart",value:function(e){var t=this,n=this.props.data.chart_data,a=this.state,r=a.canvas,o=a.vol_canvas_share,i=a.candle_width,l=a.space_between_bars;console.log("DRAW CART");var s=r.getContext("2d",!1);!function(e,t){var n=e.canvas.width,a=e.canvas.height;e.clearRect(0,0,n,a),e.fillStyle=t,e.fillRect(0,0,n,a)}(s,e);var c=this.get_min_price(n),u=this.get_max_price(n),f=this.get_max_vol(n);console.log({min_price:c,max_price:u,max_vol:f});var p=Math.floor(n.length/10);console.log({date_marker_position:p}),console.log(n.length%p),console.log("chart_data length ".concat(n.length)),console.log("Candle width = ".concat(i));var _=r.height*o,d=r.height*(1-o),v=100*(u-c),h=v/d,m=d/v,g=_/f;console.log({number_of_pennies:v,pennies_per_pixel:h,pixels_per_penny:m,pixels_per_vol:g}),this.setState({volume_canvas_height:_,chart_height:d,min_price:c,max_price:u,max_vol:f,number_of_pennies:v,pennies_per_pixel:h,pixels_per_penny:m,pixels_per_vol:g}),this.draw_price_markers(s,c,u);var y=this.state.MA_data,b=y.MA_20,w=y.MA_50,x=y.MA_200;this.draw_MA(b,"green",s),this.draw_MA(w,"blue",s),this.draw_MA(x,"red",s),n.forEach(function(e,n){var a=n*i+l*n;n%p==0&&t.draw_date_marker(a,i,e,r),t.draw_candle(s,a,e,i,m,g)})}},{key:"draw_date_marker",value:function(e,t,n,a){console.log(e),console.log(n);var r=a.getContext("2d"),o=this.parsed_date_time(n.date,n.label);console.log(o),r.beginPath(),r.moveTo(e+t/2,0),r.lineTo(e+t/2,a.height),r.stroke()}},{key:"draw_price_markers",value:function(e,t,n){var a=this.state.chart_height,r=e.canvas,o=n-t,i=g()(o/5).toFixed(4),l=0;e.strokeStyle="rgb(222, 222, 222)";for(var s=Math.floor(a/5),c=0;c<a;c++)if(c%s==0){e.beginPath(),e.moveTo(0,a-c),e.lineTo(r.width,a-c),e.stroke();var u=g()(t+l*i).toFixed(2),f=e.measureText(u);E(u,"black",10,e,r.width-f.width,a-c),l++}}},{key:"draw_volume",value:function(e,t,n,a,r,o){var i=r.canvas;r.fillRect(e,i.height-n.volume*o,a,n.volume*o)}},{key:"parsed_date_time",value:function(e,t){var n=e.slice(-4),a=n.slice(-2),r=n.slice(0,2),o=e.slice(0,4);return"".concat(r,"/").concat(a,"/").concat(o," - ").concat(t)}},{key:"get_min_price",value:function(e){return console.log(e),e.reduce(function(e,t){return t.low<e?t.low:e},e[0].low)}},{key:"get_max_price",value:function(e){return e.reduce(function(e,t){return t.high>e?t.high:e},e[0].high)}},{key:"get_max_vol",value:function(e){return e.reduce(function(e,t){return t.volume>e?t.volume:e},e[0].volume)}},{key:"draw_candle",value:function(e,t,n,a,r,o){var i,l=this.state,s=l.max_price,c=l.max_vol;e.beginPath(),e.moveTo(t+a/2,100*(s-n.high)*r),e.lineTo(t+a/2,100*(s-n.low)*r),e.stroke(),n.open>n.close?(e.fillStyle="red",i=100*(n.open-n.close)*r):n.open==n.close?(e.fillStyle="black",i=1):(e.fillStyle="green",i=100*(n.close-n.open)*r),this.draw_volume(t,c,n,a,e,o),e.fillRect(t,100*(s-n.open)*r,a,i)}},{key:"draw_MA",value:function(e,t,n){var a=n.canvas,r=this.state,o=r.candle_width,i=r.space_between_bars,l=(r.min_price,r.max_price),s=(r.number_of_pennies,r.pennies_per_pixel,r.pixels_per_penny),c=(r.pixels_per_vol,r.x_offset),u=(this.props.chart_id,a.width/(o+i));console.log({candle_count:u});var f,p=e,_=p.length;if(0==c)f=p.slice(-1*u);else{var d=_-c-u;d<0&&(d=0),c+u>_&&(Main_data.canvas_data[0].x_offset=c=_-u),f=p.slice(d,-1*c)}n.strokeStyle="".concat(t),f.forEach(function(e,t){if(!f[t-1])return console.log("COUNT IS 0");var a=t*o+i*t,r=(t-1)*o+i*(t-1);n.beginPath();var c=r+o/2,u=100*(l-f[t-1].close)*s;n.moveTo(c,u);var p=a+o/2,_=100*(l-e.close)*s;n.lineTo(p,_),n.stroke()})}},{key:"render",value:function(){var e=this.state,t=e.canvas_width,n=e.canvas_height,a=this.props,r=a.canvas_id,o=(a.chart_data,a.meta.is_loading);return p.a.createElement(p.a.Fragment,null,p.a.createElement("span",null,o&&p.a.createElement("p",null,"Loading Data....")," ")," ",t&&n&&this.render_canvas(r,t,n))}}]),t}(p.a.Component));var M=Object(_.connect)(function(e){return{stock_data:e.stock_data,meta:e.meta}})(Object(d.withRouter)(T));function E(e,t,n,a,r,o){a.fillStyle="white",a.font="bold ".concat(n,"px Arial");var i=e,l=a.measureText(i).width;a.fillRect(r,o,l,-14),a.fillStyle="black",a.fillText(i,r,o)}function A(e){var t=e.length,n=e.reduce(function(e,t){return e+t.close},0);return{close:g()((n/t).toFixed(2))}}function S(e,t,n){return n.slice(e,t)}var O=function(e){function t(e){var n;return Object(i.default)(this,t),(n=Object(s.default)(this,Object(c.default)(t).call(this,e))).state={},n}return Object(u.default)(t,e),Object(l.default)(t,[{key:"componentDidMount",value:function(){window.scrollTo(0,0)}},{key:"render",value:function(){var e=this.props,t=e.symbol,n=e.stock_data;return p.a.createElement(v.a,null,p.a.createElement("div",{className:"p-5"},p.a.createElement("div",{className:"row flex_center"},p.a.createElement("div",{className:"col flex_center"},p.a.createElement("h1",null,t))),p.a.createElement("div",{className:"row flex_center"},p.a.createElement("div",{className:"col-sm-12 vh_100"},p.a.createElement(M,{canvas_id:t,data:n.charts[t]})))))}}],[{key:"getInitialProps",value:function(){var e=Object(o.default)(r.a.mark(function e(t){var n,a,o,i,l,s,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=n=t.query.symbol,a=t.store,o=t.req,i=a.getState(),l=a.dispatch,s=i.stock_data,c=i.meta,s.charts[n]||!o){e.next=11;break}return e.next=9,Object(h.b)(n,{meta:c,dispatch:l});case 9:e.next=12;break;case 11:console.log("already got ".concat(n," data"));case 12:return e.abrupt("return",{symbol:t.query.symbol});case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),t}(p.a.Component);t.default=Object(_.connect)(function(e){return{user:e.user,stock_data:e.stock_data,meta:e.meta}})(Object(d.withRouter)(O))},yLsn:function(e,t,n){e.exports=n("AT0B")}},[["IPCE","5d41","9da1"]]]);